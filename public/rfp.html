<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFP Evaluation Tool - CMS Solution</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
        }
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        .tabs {
            display: flex;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-bottom: none;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
            transition: all 0.3s;
        }
        .tab.active {
            background-color: white;
            border-bottom: 2px solid white;
            margin-bottom: -2px;
            font-weight: 600;
            color: #2c3e50;
        }
        .tab:hover {
            background-color: #e9ecef;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th {
            background-color: #213d70;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        tr:nth-child(even):not(.category-header):not(.total-row) {
            background-color: #f8f9fa;
        }
        tr:hover:not(.category-header):not(.total-row) {
            background-color: #e9ecef;
        }
        .category-header {
            background-color: rgba(33, 61, 112, 0.1) !important;
            color: #2c3e50;
            font-weight: 600;
        }
        .category-header:hover {
            background-color: rgba(33, 61, 112, 0.15) !important;
        }
        input[type="number"], select {
            width: 100%;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        input[type="text"], textarea {
            width: 100%;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .weight {
            text-align: center;
            font-weight: 600;
        }
        .score-input {
            width: 60px;
            text-align: center;
        }
        .weighted-score {
            background-color: #ecf0f1;
            font-weight: 600;
            text-align: center;
        }
        .total-row {
            background-color: #213d70;
            color: white;
            font-weight: 600;
        }
        .total-score {
            font-size: 1.2em;
            text-align: center;
        }
        .export-btn {
            background-color: #27ae60;
          margin-top:10px;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            transition: background-color 0.3s;
        }
        .export-btn:hover {
            background-color: #229954;
        }
        .clear-btn {
            background-color: #e74c3c;
            color: white;
            margin-top:10px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .clear-btn:hover {
            background-color: #c0392b;
        }
        .button-group {
            display: flex;
            gap: 10px;
        }
        .export-section {
            position: absolute;
            top: 0px;
            right: 0px;
            padding: 10px;
            z-index: 100;
        }
        .export-section .button-group {
            margin-top: 0;
            justify-content: flex-end;
        }
        .legend {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .legend h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        .scoring-guide {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        .score-item {
            flex: 1;
            min-width: 150px;
            padding: 10px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            text-align: center;
        }
        .score-value {
            font-size: 24px;
            font-weight: bold;
            color: #3498db;
        }
        .score-label {
            font-size: 14px;
            color: #666;
        }
        .vendor-names-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #e0e0e0;
        }
        .vendor-names-section h3 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .risk-result {
            text-align: center;
            font-weight: bold;
            padding: 8px;
            min-width: 50px;
        }
        
        .risk-result.high {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .risk-result.medium {
            background-color: #fff3e0;
            color: #ef6c00;
        }
        
        .risk-result.low {
            background-color: #e8f5e8;
            color: #2e7d32;
        }
        
        .risk-select {
            width: 60px;
            text-align: center;
            padding: 5px;
        }
        
        @media print {
            .tabs, .export-btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div style="display: flex; align-items: center; margin-bottom: 20px;">
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="Layer_1" data-name="Layer 1" viewBox="0 0 216 216" width="70px" height="70px" style="margin-right: 20px;">
                <defs>
                    <style>.cls-1{fill:none;}.cls-2{fill:#ee3831;}.cls-3{clip-path:url(#clip-path);}.cls-4{fill:#fff;}</style>
                    <clipPath id="clip-path"><rect class="cls-1" x="-0.26" y="-0.26" width="216.34" height="216.34"/></clipPath>
                </defs>
                <title>M1st-Logo-Mark-Red</title>
                <rect class="cls-2" x="-0.26" y="-0.26" width="216.34" height="216.34"/>
                <g class="cls-3">
                    <path class="cls-4" d="M172.42,163.65a5.41,5.41,0,0,1-1.12-.43c-.17-.08-.35-.15-.51-.24a7.77,7.77,0,0,1-1.16-.81,5.77,5.77,0,0,1-2.24-4.66c0-4.66,0-9.31,0-14,0-3.35,0-6.69,0-10q0-27.49,0-55,0-9.41,0-18.82l.05-8.3,0-7.25a1.35,1.35,0,0,0-1.35-1.35H146.7a2.47,2.47,0,0,0-2.23,1.3L132.18,69a.56.56,0,0,0,.5.81h8.1A3.25,3.25,0,0,1,144.05,73c0,19.74,0,51.91,0,60.5,0,3.35,0,6.69,0,10q0,7,0,14a5.83,5.83,0,0,1-2.24,4.66,9,9,0,0,1-1.16.81l-.51.24a5.63,5.63,0,0,1-1.12.43,1.73,1.73,0,0,0-.33.13v3.94l.06.06,0,0h.3l.15,0h32.88l.16,0h.29s0,0,.05,0l.06-.06v-3.94a1.44,1.44,0,0,0-.32-.13"/>
                    <path class="cls-4" d="M128.27,96.48l-16.27,33-9.3,18.83L97,138.42l0,0-1.38-2.35L80.65,110.73l-16-27.07a2.29,2.29,0,0,1-.18-.29c-.3,0-.37.22-.41.42a4.14,4.14,0,0,0,0,.61c0,5.64,0,11.27,0,16.93,0,7.45,0,14.91,0,22.34s0,14.62,0,21.92c0,3.88,0,7.76,0,11.64a5.81,5.81,0,0,0,2.24,4.69,8,8,0,0,0,3.11,1.56v4.05H35.8v-4c.61-.28,1.23-.55,1.8-.85a14.26,14.26,0,0,0,1.79-1.19,3.79,3.79,0,0,0,1.47-3.18v-15c0-3.33,0-6.69,0-10q0-27.5,0-55c0-8.92,0-17.86,0-26.79a4.86,4.86,0,0,0-1.62-3.9A7.4,7.4,0,0,0,36.33,46c-.25-.07-.49-.09-.82-.15.05-1.06.07-2.11.09-3.14H66.14a4.74,4.74,0,0,1,4.3,2.72L89.31,77.7,91,80.55l18.63,31.87,13.94-28.34A1.62,1.62,0,0,1,125,83.2h8.74a.58.58,0,0,1,.53.83"/>
                    <path class="cls-4" d="M182,58.51a5.36,5.36,0,0,0-1.34-.93,12.59,12.59,0,0,0-1.71-.74c-.63-.22-1.13-.41-1.52-.58a4.93,4.93,0,0,1-1-.54,2,2,0,0,1-.6-.72,2.46,2.46,0,0,1-.2-1,1.85,1.85,0,0,1,.6-1.39,2.41,2.41,0,0,1,1.69-.58,3,3,0,0,1,2.23,1,4.7,4.7,0,0,1,1.2,2.5l0,.1h1.15l-.22-4.95h-1.16l-.29.73a5.36,5.36,0,0,0-1.26-.48,6.24,6.24,0,0,0-1.64-.23,4.5,4.5,0,0,0-3.36,1.28A4.29,4.29,0,0,0,173.27,55a4,4,0,0,0,.39,1.84,4.3,4.3,0,0,0,1,1.32A5.61,5.61,0,0,0,176,59a12.65,12.65,0,0,0,1.43.58c.52.17,1,.35,1.45.54a4.56,4.56,0,0,1,1.08.6,2.13,2.13,0,0,1,.63.75,2.29,2.29,0,0,1,.21,1,2.25,2.25,0,0,1-.67,1.76,2.79,2.79,0,0,1-1.94.62,3.07,3.07,0,0,1-1.62-.43,4.72,4.72,0,0,1-1.24-1.07,6.36,6.36,0,0,1-.84-1.38,5.81,5.81,0,0,1-.46-1.32l0-.1h-1.14l.14,5.33h1.21l.25-.88a7.17,7.17,0,0,0,1.31.75,5.66,5.66,0,0,0,5.89-.85,4.45,4.45,0,0,0,1.44-3.41,4.39,4.39,0,0,0-.32-1.76,3.77,3.77,0,0,0-.88-1.27"/>
                    <path class="cls-4" d="M193.32,63.93a3.49,3.49,0,0,1-.91.16,8.82,8.82,0,0,1-1,.07A2.48,2.48,0,0,1,190.3,64a1.34,1.34,0,0,1-.6-.6,2.83,2.83,0,0,1-.28-1c0-.42-.06-.93-.06-1.52v-8h3.82V51.09h-3.85V46.53h-2.7v4.56h-2.48v1.66h2.42v9.78a4.44,4.44,0,0,0,.72,2.7,2.89,2.89,0,0,0,2.46,1,6.27,6.27,0,0,0,2-.28c.52-.19,1.09-.41,1.68-.68l.07,0V63.87Z"/>
                    <path class="cls-4" d="M186.38,161.25h.78c.88,0,1.64-.32,1.64-1.16,0-.59-.43-1.18-1.64-1.18a4.64,4.64,0,0,0-.78.06Zm0,3.73H185.3v-6.74a12.19,12.19,0,0,1,1.91-.16,3.54,3.54,0,0,1,2.1.51,1.6,1.6,0,0,1,.61,1.39,1.67,1.67,0,0,1-1.31,1.64v.06c.59.1,1,.64,1.13,1.64a5.77,5.77,0,0,0,.42,1.66H189a4.82,4.82,0,0,1-.46-1.72,1.26,1.26,0,0,0-1.45-1.18h-.75Zm1.13-8.62a5.13,5.13,0,1,0,4.86,5.13,5,5,0,0,0-4.86-5.13Zm0-.94a6.06,6.06,0,1,1-6,6,6,6,0,0,1,6-6Z"/>
                </g>
            </svg>
            <div>
                <h1 style="margin: 0;">RFP Evaluation Tool</h1>
                <p class="subtitle" style="margin: 5px 0 0 0;">Content Management System (CMS) Solution Assessment</p>
            </div>
        </div>
        
        <div class="export-section">
            <div class="button-group">
                <button class="clear-btn" onclick="clearAllData()">Clear Data</button>
              <button class="export-btn" onclick="exportToExcel()">Export to Excel</button>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" onclick="showTab('comparison')">Vendor Comparison</div>
            <div class="tab" onclick="showTab('requirements')">Requirements Checklist</div>
            <div class="tab" onclick="showTab('evaluation')">Evaluation Matrix</div>
            <div class="tab" onclick="showTab('risk')">Risk Assessment</div>
        </div>
        
        <!-- Evaluation Matrix Tab -->
        <div id="evaluation" class="tab-content">
            <div class="legend">
                <h3>Scoring Guide</h3>
                <div class="scoring-guide">
                    <div class="score-item">
                        <div class="score-value">4</div>
                        <div class="score-label">Exceeds Requirements</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">3</div>
                        <div class="score-label">Meets Requirements</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">2</div>
                        <div class="score-label">Partially Meets</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">1</div>
                        <div class="score-label">Does Not Meet</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">0</div>
                        <div class="score-label">Not Addressed</div>
                    </div>
                </div>
            </div>
            
            <table id="evaluationTable">
                <thead>
                    <tr>
                        <th>Category</th>
                        <th>Criteria</th>
                        <th>Description</th>
                        <th>Weight</th>
                        <th class="vendor-a-header">Vendor A Score</th>
                        <th class="vendor-a-header">Vendor A Weighted</th>
                        <th class="vendor-b-header">Vendor B Score</th>
                        <th class="vendor-b-header">Vendor B Weighted</th>
                        <th>Comments</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- User Experience & Interface -->
                    <tr class="category-header">
                        <td colspan="9">User Experience & Interface (20% total)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Intuitive Dashboard</td>
                        <td>Clean, user-friendly interface with customizable dashboards</td>
                        <td class="weight">8%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Drag-and-Drop Content Creation</td>
                        <td>Visual content builder with drag-and-drop functionality</td>
                        <td class="weight">7%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Real-time Multi-device Preview</td>
                        <td>Live preview across desktop, tablet, and mobile</td>
                        <td class="weight">5%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    
                    <!-- Integration Capabilities -->
                    <tr class="category-header">
                        <td colspan="9">Integration Capabilities (18% total)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>API-first Architecture</td>
                        <td>RESTful APIs, webhooks, and comprehensive documentation</td>
                        <td class="weight">10%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>System Compatibility</td>
                        <td>Seamless integration with existing enterprise systems</td>
                        <td class="weight">8%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    
                    <!-- Scalability & Performance -->
                    <tr class="category-header">
                        <td colspan="9">Scalability & Performance (13% total)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Content Scalability</td>
                        <td>Handles growing content volume without degradation</td>
                        <td class="weight">6%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Performance Optimization</td>
                        <td>Fast load times, CDN support, caching strategies</td>
                        <td class="weight">7%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    
                    <!-- Security & Compliance -->
                    <tr class="category-header">
                        <td colspan="9">Security & Compliance (21% total)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Data Security</td>
                        <td>Encryption at rest and in transit, secure authentication</td>
                        <td class="weight">8%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Regulatory Compliance</td>
                        <td>GDPR, CCPA, SOC2 compliance certifications</td>
                        <td class="weight">7%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Access Control</td>
                        <td>Role-based permissions, SSO support, audit logs</td>
                        <td class="weight">6%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    
                    <!-- Content Management & Workflow -->
                    <tr class="category-header">
                        <td colspan="9">Content Management & Workflow (15% total)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>SEO Optimization</td>
                        <td>Built-in SEO tools, meta tags, sitemap generation</td>
                        <td class="weight">5%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Workflow Management</td>
                        <td>Approval workflows, version control, content scheduling</td>
                        <td class="weight">7%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Asana Integration</td>
                        <td>Native or API-based integration with Asana</td>
                        <td class="weight">3%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    
                    <!-- Additional Criteria -->
                    <tr class="category-header">
                        <td colspan="9">Additional Criteria (13% total)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Mobile Responsiveness</td>
                        <td>Automatic content adaptation across all devices</td>
                        <td class="weight">4%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Support Services</td>
                        <td>24/7 support, SLA guarantees, documentation quality</td>
                        <td class="weight">3%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Personalization Engine</td>
                        <td>AI-driven content personalization, A/B testing</td>
                        <td class="weight">3%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Analytics Integration</td>
                        <td>Google Analytics, Adobe Analytics compatibility</td>
                        <td class="weight">3%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    
                    <!-- Infrastructure -->
                    <tr class="category-header">
                        <td colspan="9">Infrastructure & Operations (10% total)</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Data Protection</td>
                        <td>Automated backups, disaster recovery plans</td>
                        <td class="weight">4%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Azure Deployment</td>
                        <td>Native Azure support, auto-scaling, monitoring</td>
                        <td class="weight">6%</td>
                        <td><input type="number" class="score-input vendorA" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorA-weighted">0.00</td>
                        <td><input type="number" class="score-input vendorB" min="0" max="4" step="1" onchange="calculateScores()"></td>
                        <td class="weighted-score vendorB-weighted">0.00</td>
                        <td><input type="text" placeholder="Comments..."></td>
                    </tr>
                    
                    <!-- Total Score Row -->
                    <tr class="total-row">
                        <td colspan="3">TOTAL SCORE</td>
                        <td>100%</td>
                        <td class="total-score" id="vendorA-total">0.00</td>
                        <td class="total-score" id="vendorA-weighted-total">0.00</td>
                        <td class="total-score" id="vendorB-total">0.00</td>
                        <td class="total-score" id="vendorB-weighted-total">0.00</td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Vendor Comparison Tab -->
        <div id="comparison" class="tab-content active">
            <h2>Vendor Comparison Summary</h2>
            
            <div class="vendor-names-section">
                <h3>Enter Vendor Names</h3>
                <div style="display: flex; gap: 20px; margin-bottom: 30px;">
                    <div style="flex: 1;">
                        <label for="vendorAName" style="font-weight: 600; display: block; margin-bottom: 5px;">Vendor A Name:</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="vendorAName" placeholder="Enter first vendor name or choose from dropdown" 
                                   style="min-width: 250px; flex: 1; padding: 10px; font-size: 16px; border: 1px solid #ddd; border-radius: 4px;" 
                                   onchange="updateVendorNames()">
                            <select id="vendorADropdown" style="padding: 10px; font-size: 16px; width: 100px; border: 1px solid #ddd; border-radius: 4px;" 
                                    onchange="selectVendorA(this.value)">
                                <option value="">Select...</option>
                                <option value="Storyblok">Storyblok</option>
                                <option value="Contentful">Contentful</option>
                            </select>
                        </div>
                    </div>
                    <div style="flex: 1;">
                        <label for="vendorBName" style="font-weight: 600; display: block; margin-bottom: 5px;">Vendor B Name:</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" id="vendorBName" placeholder="Enter second vendor name or choose from dropdown" 
                                   style="min-width: 250px; flex: 1; padding: 10px; font-size: 16px; border: 1px solid #ddd; border-radius: 4px;" 
                                   onchange="updateVendorNames()">
                            <select id="vendorBDropdown" style="padding: 10px; font-size: 16px; width: 100px; border: 1px solid #ddd; border-radius: 4px;" 
                                    onchange="selectVendorB(this.value)">
                                <option value="">Select...</option>
                                <option value="Storyblok">Storyblok</option>
                                <option value="Contentful">Contentful</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Evaluation Criteria</th>
                        <th class="vendor-a-header">Vendor A</th>
                        <th class="vendor-b-header">Vendor B</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header">
                        <td colspan="4">Company Profile</td>
                    </tr>
                    <tr>
                        <td>Company Name</td>
                        <td><input type="text" placeholder="Enter vendor name"></td>
                        <td><input type="text" placeholder="Enter vendor name"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Years in Business</td>
                        <td><input type="text" placeholder="e.g., 15 years"></td>
                        <td><input type="text" placeholder="e.g., 15 years"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Number of Employees</td>
                        <td><input type="text" placeholder="e.g., 500+"></td>
                        <td><input type="text" placeholder="e.g., 500+"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Annual Revenue</td>
                        <td><input type="text" placeholder="e.g., $50M"></td>
                        <td><input type="text" placeholder="e.g., $50M"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Number of CMS Implementations</td>
                        <td><input type="text" placeholder="e.g., 200+"></td>
                        <td><input type="text" placeholder="e.g., 200+"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    
                    <tr class="category-header">
                        <td colspan="4">Technical Specifications</td>
                    </tr>
                    <tr>
                        <td>Programming Languages</td>
                        <td><input type="text" placeholder="e.g., Java, Python"></td>
                        <td><input type="text" placeholder="e.g., Java, Python"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Database Support</td>
                        <td><input type="text" placeholder="e.g., PostgreSQL, MySQL"></td>
                        <td><input type="text" placeholder="e.g., PostgreSQL, MySQL"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Hosting Options</td>
                        <td><input type="text" placeholder="e.g., Cloud, On-premise"></td>
                        <td><input type="text" placeholder="e.g., Cloud, On-premise"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Mobile App Availability</td>
                        <td><input type="text" placeholder="e.g., iOS, Android"></td>
                        <td><input type="text" placeholder="e.g., iOS, Android"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    
                    <tr class="category-header">
                        <td colspan="4">Cost Analysis</td>
                    </tr>
                    <tr>
                        <td>Implementation Cost</td>
                        <td><input type="text" placeholder="e.g., $150,000"></td>
                        <td><input type="text" placeholder="e.g., $150,000"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Annual License Cost</td>
                        <td><input type="text" placeholder="e.g., $50,000/year"></td>
                        <td><input type="text" placeholder="e.g., $50,000/year"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Total 3-Year Cost</td>
                        <td><input type="text" placeholder="e.g., $300,000"></td>
                        <td><input type="text" placeholder="e.g., $300,000"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    
                    <tr class="category-header">
                        <td colspan="4">Implementation Timeline</td>
                    </tr>
                    <tr>
                        <td>Discovery Phase</td>
                        <td><input type="text" placeholder="e.g., 2 weeks"></td>
                        <td><input type="text" placeholder="e.g., 2 weeks"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Design & Development</td>
                        <td><input type="text" placeholder="e.g., 12 weeks"></td>
                        <td><input type="text" placeholder="e.g., 12 weeks"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Testing & QA</td>
                        <td><input type="text" placeholder="e.g., 4 weeks"></td>
                        <td><input type="text" placeholder="e.g., 4 weeks"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Training & Documentation</td>
                        <td><input type="text" placeholder="e.g., 2 weeks"></td>
                        <td><input type="text" placeholder="e.g., 2 weeks"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Total Implementation Time</td>
                        <td><input type="text" placeholder="e.g., 20 weeks"></td>
                        <td><input type="text" placeholder="e.g., 20 weeks"></td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Requirements Checklist Tab -->
        <div id="requirements" class="tab-content">
            <h2>Detailed Requirements Checklist</h2>
            <p>Legend: Y = Yes, N = No, P = Partial</p>
            <table>
                <thead>
                    <tr>
                        <th>Requirement</th>
                        <th>Priority (H/M/L)</th>
                        <th class="vendor-a-header">Vendor A (Y/N/P)</th>
                        <th class="vendor-b-header">Vendor B (Y/N/P)</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header">
                        <td colspan="5">Content Management Features</td>
                    </tr>
                    <tr>
                        <td>WYSIWYG Editor</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Markdown Support</td>
                        <td>L</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Media Library Management</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Content Templates</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Content Scheduling</td>
                        <td>M</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Multi-language Support</td>
                        <td>M</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    
                    <tr class="category-header">
                        <td colspan="5">Integration Features</td>
                    </tr>
                    <tr>
                        <td>REST API</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>GraphQL Support</td>
                        <td>L</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Webhook Support</td>
                        <td>M</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>SSO Integration</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Email Marketing Integration</td>
                        <td>M</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Digital Design System Integration</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Salesforce Integration</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    
                    <tr class="category-header">
                        <td colspan="5">Performance Requirements</td>
                    </tr>
                    <tr>
                        <td>Page Load Time < 3 seconds</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>99.9% Uptime SLA</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>CDN Integration</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Database Query Optimization</td>
                        <td>M</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    
                    <tr class="category-header">
                        <td colspan="5">Security Requirements</td>
                    </tr>
                    <tr>
                        <td>Two-Factor Authentication</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>IP Whitelisting</td>
                        <td>M</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>Regular Security Audits</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>HTTPS/SSL Support</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                    <tr>
                        <td>ADA/WCAG 2.1 AA Compliance</td>
                        <td>H</td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td>
                            <select>
                                <option value="">--</option>
                                <option value="Y">Y</option>
                                <option value="N">N</option>
                                <option value="P">P</option>
                            </select>
                        </td>
                        <td><input type="text" placeholder="Notes..."></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- Risk Assessment Tab -->
        <div id="risk" class="tab-content">
            <h2>Risk Assessment Matrix</h2>
            <p>Risk Level: H = High, M = Medium, L = Low | Overall Risk = Probability  Impact</p>
            <table>
                <thead>
                    <tr>
                        <th rowspan="2">Risk Category</th>
                        <th rowspan="2">Risk Description</th>
                        <th colspan="3" class="vendor-a-header">Vendor A Risk Assessment</th>
                        <th colspan="3" class="vendor-b-header">Vendor B Risk Assessment</th>
                        <th rowspan="2">Mitigation Strategy</th>
                    </tr>
                    <tr>
                        <th class="vendor-a-header">Probability</th>
                        <th class="vendor-a-header">Impact</th>
                        <th class="vendor-a-header">Overall Risk</th>
                        <th class="vendor-b-header">Probability</th>
                        <th class="vendor-b-header">Impact</th>
                        <th class="vendor-b-header">Overall Risk</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header">
                        <td colspan="9">Technical Risks</td>
                    </tr>
                    <tr>
                        <td>Integration Complexity</td>
                        <td>Difficulty integrating with existing systems and APIs</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Data Migration</td>
                        <td>Risk of data loss or corruption during migration</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Performance Issues</td>
                        <td>System may not meet performance requirements</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Security Vulnerabilities</td>
                        <td>Potential security gaps or vulnerabilities in the platform</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    
                    <tr class="category-header">
                        <td colspan="9">Business Risks</td>
                    </tr>
                    <tr>
                        <td>Vendor Stability</td>
                        <td>Vendor financial stability and long-term viability</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Budget Overrun</td>
                        <td>Project costs may exceed allocated budget</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Timeline Delays</td>
                        <td>Implementation may take longer than planned</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Contract Terms</td>
                        <td>Unfavorable contract terms or licensing restrictions</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    
                    <tr class="category-header">
                        <td colspan="9">Operational Risks</td>
                    </tr>
                    <tr>
                        <td>User Adoption</td>
                        <td>Staff resistance to new system or poor user experience</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Training Requirements</td>
                        <td>Insufficient training resources or complex learning curve</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Support Quality</td>
                        <td>Inadequate vendor support or long response times</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                    <tr>
                        <td>Maintenance & Updates</td>
                        <td>Platform maintenance requirements or update complications</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td>
                            <select class="risk-select" onchange="calculateRiskLevel(this)">
                                <option value="">--</option>
                                <option value="H">H</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                            </select>
                        </td>
                        <td class="risk-result">--</td>
                        <td><textarea rows="2" placeholder="Enter mitigation strategy..."></textarea></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <script>
        // Local Storage Functions
        function saveToLocalStorage() {
            const data = {
                vendorAName: document.getElementById('vendorAName')?.value || '',
                vendorBName: document.getElementById('vendorBName')?.value || '',
                formData: {}
            };
            
            // Save all input, select, and textarea values
            const inputs = document.querySelectorAll('input[type="text"], input[type="number"], select, textarea');
            inputs.forEach((input, globalIndex) => {
                let key = '';
                
                if (input.id) {
                    key = input.id;
                } else if (input.name) {
                    key = input.name;
                } else {
                    // Create a more robust unique identifier
                    const row = input.closest('tr');
                    const table = input.closest('table');
                    
                    if (row && table) {
                        const tableIndex = Array.from(document.querySelectorAll('table')).indexOf(table);
                        const rowIndex = Array.from(table.querySelectorAll('tr')).indexOf(row);
                        const cell = input.closest('td') || input.closest('th');
                        const cellIndex = cell ? Array.from(row.children).indexOf(cell) : -1;
                        const inputsInCell = cell ? cell.querySelectorAll(input.tagName.toLowerCase()) : [];
                        const inputIndex = Array.from(inputsInCell).indexOf(input);
                        
                        key = `table_${tableIndex}_row_${rowIndex}_cell_${cellIndex}_${input.tagName.toLowerCase()}_${inputIndex}`;
                    } else {
                        // Fallback to global index if no table structure
                        key = `global_${input.tagName.toLowerCase()}_${globalIndex}`;
                    }
                }
                
                // Store the value
                data.formData[key] = input.value;
            });
            
            try {
                localStorage.setItem('rfpEvaluationData', JSON.stringify(data));
                console.log('Data saved to localStorage:', Object.keys(data.formData).length, 'form fields');
            } catch (error) {
                console.error('Failed to save to localStorage:', error);
            }
        }
        
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('rfpEvaluationData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    console.log('Loading data from localStorage:', Object.keys(data.formData).length, 'form fields');
                    
                    // Restore vendor names
                    if (data.vendorAName && document.getElementById('vendorAName')) {
                        document.getElementById('vendorAName').value = data.vendorAName;
                    }
                    if (data.vendorBName && document.getElementById('vendorBName')) {
                        document.getElementById('vendorBName').value = data.vendorBName;
                    }
                    
                    // Restore form data
                    Object.keys(data.formData).forEach(key => {
                        let element = null;
                        
                        // Try to find by ID first
                        if (key && !key.startsWith('table_') && !key.startsWith('global_')) {
                            element = document.getElementById(key) || document.querySelector(`[name="${key}"]`);
                        }
                        
                        // If not found, try position-based lookup
                        if (!element) {
                            if (key.startsWith('table_')) {
                                // Parse position-based key: table_X_row_Y_cell_Z_tagname_W
                                const parts = key.split('_');
                                if (parts.length >= 7) {
                                    const tableIndex = parseInt(parts[1]);
                                    const rowIndex = parseInt(parts[3]);
                                    const cellIndex = parseInt(parts[5]);
                                    const tagName = parts[6];
                                    const inputIndex = parseInt(parts[7]);
                                    
                                    const tables = document.querySelectorAll('table');
                                    if (tables[tableIndex]) {
                                        const rows = tables[tableIndex].querySelectorAll('tr');
                                        if (rows[rowIndex]) {
                                            const cells = rows[rowIndex].children;
                                            if (cells[cellIndex]) {
                                                const inputs = cells[cellIndex].querySelectorAll(tagName);
                                                if (inputs[inputIndex]) {
                                                    element = inputs[inputIndex];
                                                }
                                            }
                                        }
                                    }
                                }
                            } else if (key.startsWith('global_')) {
                                // Parse global key: global_tagname_X
                                const parts = key.split('_');
                                if (parts.length >= 3) {
                                    const tagName = parts[1];
                                    const globalIndex = parseInt(parts[2]);
                                    const allInputs = document.querySelectorAll(`${tagName}[type="text"], ${tagName}[type="number"], ${tagName}`);
                                    if (allInputs[globalIndex]) {
                                        element = allInputs[globalIndex];
                                    }
                                }
                            }
                        }
                        
                        // Set the value if element was found
                        if (element && data.formData[key] !== undefined) {
                            element.value = data.formData[key];
                        }
                    });
                    
                    // Update vendor names in headers and recalculate scores
                    updateVendorNames();
                    calculateScores();
                    
                    console.log('Data loaded from local storage successfully');
                } catch (error) {
                    console.error('Error loading data from local storage:', error);
                }
            }
        }
        
        function clearLocalStorage() {
            localStorage.removeItem('rfpEvaluationData');
            console.log('Local storage cleared');
        }
        
        // Debug function to inspect saved data
        function debugLocalStorage() {
            const savedData = localStorage.getItem('rfpEvaluationData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    console.log('=== DEBUG: Local Storage Contents ===');
                    console.log('Vendor A Name:', data.vendorAName);
                    console.log('Vendor B Name:', data.vendorBName);
                    console.log('Total form fields saved:', Object.keys(data.formData).length);
                    console.log('Form data keys:', Object.keys(data.formData));
                    console.log('Sample form data:', Object.fromEntries(Object.entries(data.formData).slice(0, 10)));
                    return data;
                } catch (error) {
                    console.error('Error parsing saved data:', error);
                }
            } else {
                console.log('No data found in localStorage');
            }
        }
        
        // Auto-save functionality
        function setupAutoSave() {
            // Save on input changes
            document.addEventListener('input', function(e) {
                if (e.target.matches('input, select, textarea')) {
                    clearTimeout(window.autoSaveTimeout);
                    window.autoSaveTimeout = setTimeout(saveToLocalStorage, 1000); // Save after 1 second of inactivity
                }
            });
            
            // Save on change events (for dropdowns and other elements that don't trigger input)
            document.addEventListener('change', function(e) {
                if (e.target.matches('input, select, textarea')) {
                    clearTimeout(window.autoSaveTimeout);
                    window.autoSaveTimeout = setTimeout(saveToLocalStorage, 1000);
                }
            });
            
            // Save on page unload
            window.addEventListener('beforeunload', saveToLocalStorage);
            
            // Save periodically (every 30 seconds)
            setInterval(saveToLocalStorage, 30000);
        }

        // Vendor Data Objects
        const vendorData = {
            'Storyblok': {
                companyName: 'Storyblok',
                yearsInBusiness: '8 years (since 2017)',
                numberOfEmployees: '200+',
                annualRevenue: 'Private (Estimated $50M+)',
                numberOfImplementations: '1000+',
                programmingLanguages: 'JavaScript, TypeScript, Vue.js, React',
                databaseSupport: 'PostgreSQL, MongoDB, Cloud Database',
                hostingOptions: 'Cloud (AWS, Azure, Google Cloud), CDN',
                mobileAppAvailability: 'iOS, Android (Progressive Web App)',
                implementationCost: '$75,000 - $200,000',
                annualLicenseCost: '$1,200 - $10,000+/year',
                total3YearCost: '$79,600 - $230,000',
                discoveryPhase: '2-3 weeks',
                designDevelopment: '8-16 weeks',
                testingQA: '2-4 weeks',
                trainingDocumentation: '1-2 weeks',
                totalImplementationTime: '13-25 weeks'
            },
            'Contentful': {
                companyName: 'Contentful',
                yearsInBusiness: '12 years (since 2013)',
                numberOfEmployees: '600+',
                annualRevenue: 'Private ($3B valuation as of 2021)',
                numberOfImplementations: '5000+ (30% of Fortune 500)',
                programmingLanguages: 'JavaScript, TypeScript, React, Node.js, GraphQL',
                databaseSupport: 'Content Infrastructure (Cloud), API-first architecture',
                hostingOptions: 'Cloud (AWS Global CDN), Multi-region hosting',
                mobileAppAvailability: 'iOS, Android, Mobile SDKs for React Native',
                implementationCost: '$75,000 - $250,000',
                annualLicenseCost: '$3,600 - $50,000+/year',
                total3YearCost: '$86,400 - $400,000',
                discoveryPhase: '2-4 weeks',
                designDevelopment: '8-16 weeks',
                testingQA: '3-4 weeks',
                trainingDocumentation: '2-3 weeks',
                totalImplementationTime: '15-27 weeks'
            }
        };

        function selectVendorA(vendorName) {
            if (vendorName && vendorData[vendorName]) {
                document.getElementById('vendorAName').value = vendorName;
                populateVendorData('A', vendorData[vendorName]);
                updateVendorNames();
                // Reset dropdown after selection
                document.getElementById('vendorADropdown').value = '';
                
                // Trigger change event for vendor name input to ensure it's saved
                document.getElementById('vendorAName').dispatchEvent(new Event('change', { bubbles: true }));
            }
        }

        function selectVendorB(vendorName) {
            if (vendorName && vendorData[vendorName]) {
                document.getElementById('vendorBName').value = vendorName;
                populateVendorData('B', vendorData[vendorName]);
                updateVendorNames();
                // Reset dropdown after selection
                document.getElementById('vendorBDropdown').value = '';
                
                // Trigger change event for vendor name input to ensure it's saved
                document.getElementById('vendorBName').dispatchEvent(new Event('change', { bubbles: true }));
            }
        }

        function populateVendorData(vendor, data) {
            // Get all table rows in the comparison tab
            const comparisonTable = document.querySelector('#comparison table tbody');
            const rows = comparisonTable.querySelectorAll('tr');
            
            // Map data to table rows based on the criteria text
            const fieldMapping = {
                'Company Name': data.companyName,
                'Years in Business': data.yearsInBusiness,
                'Number of Employees': data.numberOfEmployees,
                'Annual Revenue': data.annualRevenue,
                'Number of CMS Implementations': data.numberOfImplementations,
                'Programming Languages': data.programmingLanguages,
                'Database Support': data.databaseSupport,
                'Hosting Options': data.hostingOptions,
                'Mobile App Availability': data.mobileAppAvailability,
                'Implementation Cost': data.implementationCost,
                'Annual License Cost': data.annualLicenseCost,
                'Total 3-Year Cost': data.total3YearCost,
                'Discovery Phase': data.discoveryPhase,
                'Design & Development': data.designDevelopment,
                'Testing & QA': data.testingQA,
                'Training & Documentation': data.trainingDocumentation,
                'Total Implementation Time': data.totalImplementationTime
            };

            rows.forEach(row => {
                // Skip category headers
                if (row.classList.contains('category-header')) return;
                
                const cells = row.querySelectorAll('td');
                if (cells.length >= 3) {
                    const criteriaText = cells[0].textContent.trim();
                    
                    if (fieldMapping[criteriaText]) {
                        // Determine which column to populate (vendor A = column 1, vendor B = column 2)
                        const targetColumnIndex = vendor === 'A' ? 1 : 2;
                        const targetInput = cells[targetColumnIndex].querySelector('input[type="text"]');
                        
                        if (targetInput) {
                            targetInput.value = fieldMapping[criteriaText];
                            // Trigger change event to ensure auto-save captures this
                            targetInput.dispatchEvent(new Event('change', { bubbles: true }));
                        }
                    }
                }
            });
            
            // Save the updated data with a slight delay to ensure DOM updates are complete
            setTimeout(() => {
                saveToLocalStorage();
                console.log(`Vendor ${vendor} data populated and saved`);
            }, 100);
        }

        function updateVendorNames() {
            const vendorAName = document.getElementById('vendorAName').value || 'Vendor A';
            const vendorBName = document.getElementById('vendorBName').value || 'Vendor B';
            
            // Update all vendor A headers
            const vendorAHeaders = document.querySelectorAll('.vendor-a-header');
            vendorAHeaders.forEach(header => {
                const text = header.textContent;
                if (text.includes('Score')) {
                    header.textContent = vendorAName + ' Score';
                } else if (text.includes('Weighted')) {
                    header.textContent = vendorAName + ' Weighted';
                } else if (text.includes('(Y/N/P)')) {
                    header.textContent = vendorAName + ' (Y/N/P)';
                } else if (text.includes('Risk Assessment')) {
                    header.textContent = vendorAName + ' Risk Assessment';
                } else if (text.includes('Probability')) {
                    header.textContent = 'Probability';
                } else if (text.includes('Impact')) {
                    header.textContent = 'Impact';
                } else if (text.includes('Overall Risk')) {
                    header.textContent = 'Overall Risk';
                } else {
                    header.textContent = vendorAName;
                }
            });
            
            // Update all vendor B headers
            const vendorBHeaders = document.querySelectorAll('.vendor-b-header');
            vendorBHeaders.forEach(header => {
                const text = header.textContent;
                if (text.includes('Score')) {
                    header.textContent = vendorBName + ' Score';
                } else if (text.includes('Weighted')) {
                    header.textContent = vendorBName + ' Weighted';
                } else if (text.includes('(Y/N/P)')) {
                    header.textContent = vendorBName + ' (Y/N/P)';
                } else if (text.includes('Risk Assessment')) {
                    header.textContent = vendorBName + ' Risk Assessment';
                } else if (text.includes('Probability')) {
                    header.textContent = 'Probability';
                } else if (text.includes('Impact')) {
                    header.textContent = 'Impact';
                } else if (text.includes('Overall Risk')) {
                    header.textContent = 'Overall Risk';
                } else {
                    header.textContent = vendorBName;
                }
            });
        }
        
        // Calculate risk level based on probability and impact
        function calculateRiskLevel(selectElement) {
            const row = selectElement.closest('tr');
            if (!row) return;
            
            const selects = row.querySelectorAll('.risk-select');
            const results = row.querySelectorAll('.risk-result');
            
            // Process in pairs: probability, impact, result
            for (let i = 0; i < selects.length; i += 2) {
                if (i + 1 < selects.length && Math.floor(i / 2) < results.length) {
                    const probabilitySelect = selects[i];
                    const impactSelect = selects[i + 1];
                    const resultCell = results[Math.floor(i / 2)];
                    
                    const probability = probabilitySelect.value;
                    const impact = impactSelect.value;
                    
                    if (probability && impact) {
                        const riskLevel = calculateOverallRisk(probability, impact);
                        resultCell.textContent = riskLevel;
                        
                        // Remove existing risk classes
                        resultCell.classList.remove('high', 'medium', 'low');
                        
                        // Add appropriate risk class
                        if (riskLevel === 'H') {
                            resultCell.classList.add('high');
                        } else if (riskLevel === 'M') {
                            resultCell.classList.add('medium');
                        } else if (riskLevel === 'L') {
                            resultCell.classList.add('low');
                        }
                    } else {
                        resultCell.textContent = '--';
                        resultCell.classList.remove('high', 'medium', 'low');
                    }
                }
            }
        }
        
        // Risk calculation matrix
        function calculateOverallRisk(probability, impact) {
            const riskMatrix = {
                'H': { 'H': 'H', 'M': 'H', 'L': 'M' },
                'M': { 'H': 'H', 'M': 'M', 'L': 'L' },
                'L': { 'H': 'M', 'M': 'L', 'L': 'L' }
            };
            
            return riskMatrix[probability] && riskMatrix[probability][impact] 
                ? riskMatrix[probability][impact] 
                : '--';
        }
        
        function showTab(tabName) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
        
        function calculateScores() {
            const rows = document.querySelectorAll('#evaluationTable tbody tr');
            let vendorATotalScore = 0;
            let vendorAWeightedTotal = 0;
            let vendorBTotalScore = 0;
            let vendorBWeightedTotal = 0;
            let count = 0;
            
            rows.forEach(row => {
                if (row.classList.contains('category-header') || row.classList.contains('total-row')) {
                    return;
                }
                
                const weightCell = row.querySelector('.weight');
                if (weightCell) {
                    const weight = parseFloat(weightCell.textContent) / 100;
                    
                    // Vendor A calculations
                    const vendorAScoreInput = row.querySelector('.vendorA');
                    const vendorAWeightedCell = row.querySelector('.vendorA-weighted');
                    if (vendorAScoreInput && vendorAWeightedCell) {
                        const score = parseFloat(vendorAScoreInput.value) || 0;
                        const weighted = score * weight;
                        vendorAWeightedCell.textContent = (weighted * 100).toFixed(2);
                        vendorATotalScore += score;
                        vendorAWeightedTotal += weighted;
                        if (score > 0) count++;
                    }
                    
                    // Vendor B calculations
                    const vendorBScoreInput = row.querySelector('.vendorB');
                    const vendorBWeightedCell = row.querySelector('.vendorB-weighted');
                    if (vendorBScoreInput && vendorBWeightedCell) {
                        const score = parseFloat(vendorBScoreInput.value) || 0;
                        const weighted = score * weight;
                        vendorBWeightedCell.textContent = (weighted * 100).toFixed(2);
                        vendorBTotalScore += score;
                        vendorBWeightedTotal += weighted;
                    }
                }
            });
            
            // Update totals
            document.getElementById('vendorA-total').textContent = (count > 0 ? vendorATotalScore / count : 0).toFixed(2);
            document.getElementById('vendorA-weighted-total').textContent = (vendorAWeightedTotal * 100).toFixed(2);
            document.getElementById('vendorB-total').textContent = (count > 0 ? vendorBTotalScore / count : 0).toFixed(2);
            document.getElementById('vendorB-weighted-total').textContent = (vendorBWeightedTotal * 100).toFixed(2);
        }
        
        function exportToExcel() {
            try {
                const vendorAName = document.getElementById('vendorAName')?.value || 'Vendor A';
                const vendorBName = document.getElementById('vendorBName')?.value || 'Vendor B';
                const timestamp = new Date().toISOString().split('T')[0];
                
                // Create proper Excel XML workbook
                let xlsContent = '';
                
                // XML declaration and workbook start
                xlsContent += '<?xml version="1.0"?>\n';
                xlsContent += '<?mso-application progid="Excel.Sheet"?>\n';
                xlsContent += '<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\n';
                xlsContent += ' xmlns:o="urn:schemas-microsoft-com:office:office"\n';
                xlsContent += ' xmlns:x="urn:schemas-microsoft-com:office:excel"\n';
                xlsContent += ' xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\n';
                xlsContent += ' xmlns:html="http://www.w3.org/TR/REC-html40">\n';
                
                // Document properties
                xlsContent += '<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\n';
                xlsContent += '<Title>RFP Evaluation Tool</Title>\n';
                xlsContent += '<Subject>CMS Solution Assessment</Subject>\n';
                xlsContent += '<Created>' + new Date().toISOString() + '</Created>\n';
                xlsContent += '</DocumentProperties>\n';
                
                // Styles
                xlsContent += '<Styles>\n';
                xlsContent += '<Style ss:ID="Default" ss:Name="Normal">\n';
                xlsContent += '<Alignment ss:Vertical="Bottom"/>\n';
                xlsContent += '<Borders/>\n';
                xlsContent += '<Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000"/>\n';
                xlsContent += '<Interior/>\n';
                xlsContent += '<NumberFormat/>\n';
                xlsContent += '<Protection/>\n';
                xlsContent += '</Style>\n';
                
                xlsContent += '<Style ss:ID="HeaderStyle">\n';
                xlsContent += '<Font ss:FontName="Calibri" ss:Size="12" ss:Color="#FFFFFF" ss:Bold="1"/>\n';
                xlsContent += '<Interior ss:Color="#213d70" ss:Pattern="Solid"/>\n';
                xlsContent += '<Alignment ss:Horizontal="Center" ss:Vertical="Center"/>\n';
                xlsContent += '<Borders>\n';
                xlsContent += '<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '</Borders>\n';
                xlsContent += '</Style>\n';
                
                xlsContent += '<Style ss:ID="CategoryStyle">\n';
                xlsContent += '<Font ss:FontName="Calibri" ss:Size="11" ss:Bold="1"/>\n';
                xlsContent += '<Interior ss:Color="#E8F0FE" ss:Pattern="Solid"/>\n';
                xlsContent += '<Borders>\n';
                xlsContent += '<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '</Borders>\n';
                xlsContent += '</Style>\n';
                
                xlsContent += '<Style ss:ID="TotalStyle">\n';
                xlsContent += '<Font ss:FontName="Calibri" ss:Size="11" ss:Color="#FFFFFF" ss:Bold="1"/>\n';
                xlsContent += '<Interior ss:Color="#213d70" ss:Pattern="Solid"/>\n';
                xlsContent += '<Borders>\n';
                xlsContent += '<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '</Borders>\n';
                xlsContent += '</Style>\n';
                
                xlsContent += '<Style ss:ID="DataStyle">\n';
                xlsContent += '<Borders>\n';
                xlsContent += '<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '</Borders>\n';
                xlsContent += '</Style>\n';
                
                xlsContent += '<Style ss:ID="NumberStyle">\n';
                xlsContent += '<NumberFormat ss:Format="0.00"/>\n';
                xlsContent += '<Borders>\n';
                xlsContent += '<Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '<Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>\n';
                xlsContent += '</Borders>\n';
                xlsContent += '</Style>\n';
                xlsContent += '</Styles>\n';
                
                // Add worksheets for each tab
                xlsContent += exportTableToExcelXML('Vendor Comparison', '#comparison table', vendorAName, vendorBName);
                xlsContent += exportTableToExcelXML('Requirements Checklist', '#requirements table', vendorAName, vendorBName);
                xlsContent += exportTableToExcelXML('Evaluation Matrix', '#evaluationTable', vendorAName, vendorBName);
                xlsContent += exportTableToExcelXML('Risk Assessment', '#risk table', vendorAName, vendorBName);
                
                // Add summary worksheet
                xlsContent += createSummaryWorksheet(vendorAName, vendorBName, timestamp);
                
                // Close workbook
                xlsContent += '</Workbook>';
                
                // Create and download file
                const blob = new Blob([xlsContent], { 
                    type: 'application/vnd.ms-excel;charset=utf-8;' 
                });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                
                link.setAttribute('href', url);
                link.setAttribute('download', `RFP_Evaluation_Complete_${timestamp}.xls`);
                link.style.visibility = 'hidden';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                console.log('Excel export completed successfully');
            } catch (error) {
                console.error('Excel export failed:', error);
                alert('Excel export failed. Please check the console for details.');
            }
        }
        
        function exportTableToExcelXML(sheetName, tableSelector, vendorAName, vendorBName) {
            const table = document.querySelector(tableSelector);
            if (!table) {
                console.warn(`Table not found: ${tableSelector}`);
                return `<Worksheet ss:Name="${sheetName}"><Table><Row><Cell><Data ss:Type="String">Table not found</Data></Cell></Row></Table></Worksheet>\n`;
            }
            
            let xmlContent = `<Worksheet ss:Name="${sheetName.replace(/[^\w\s]/g, '').substring(0, 31)}">\n<Table>\n`;
            
            // Add title row
            xmlContent += `<Row><Cell ss:StyleID="HeaderStyle" ss:MergeAcross="${getTableColumnCount(table) - 1}"><Data ss:Type="String">${sheetName} (${new Date().toISOString().split('T')[0]})</Data></Cell></Row>\n`;
            xmlContent += '<Row></Row>\n'; // Empty row for spacing
            
            const rows = table.querySelectorAll('tr');
            
            rows.forEach((row, rowIndex) => {
                xmlContent += '<Row>';
                const cells = row.querySelectorAll('th, td');
                
                cells.forEach((cell, cellIndex) => {
                    let cellContent = '';
                    let styleID = 'DataStyle';
                    let colspan = parseInt(cell.getAttribute('colspan')) || 1;
                    
                    // Determine cell style
                    if (cell.tagName === 'TH') {
                        styleID = 'HeaderStyle';
                    } else if (row.classList.contains('category-header')) {
                        styleID = 'CategoryStyle';
                    } else if (row.classList.contains('total-row')) {
                        styleID = 'TotalStyle';
                    }
                    
                    // Get cell content
                    const input = cell.querySelector('input, select, textarea');
                    if (input) {
                        cellContent = input.value || '';
                    } else {
                        cellContent = cell.textContent.trim();
                    }
                    
                    // Replace vendor placeholders with actual names
                    cellContent = cellContent.replace(/Vendor A/g, vendorAName);
                    cellContent = cellContent.replace(/Vendor B/g, vendorBName);
                    
                    // Escape XML characters
                    cellContent = escapeXML(cellContent);
                    
                    // Determine data type and adjust style
                    const isNumber = !isNaN(parseFloat(cellContent)) && isFinite(cellContent) && cellContent !== '' && cellContent.match(/^\d*\.?\d+$/);
                    const dataType = isNumber ? 'Number' : 'String';
                    
                    if (isNumber && styleID === 'DataStyle') {
                        styleID = 'NumberStyle';
                    }
                    
                    // Build cell XML
                    let cellXML = `<Cell ss:StyleID="${styleID}"`;
                    if (colspan > 1) {
                        cellXML += ` ss:MergeAcross="${colspan - 1}"`;
                    }
                    cellXML += `><Data ss:Type="${dataType}">${cellContent}</Data></Cell>`;
                    
                    xmlContent += cellXML;
                });
                
                xmlContent += '</Row>\n';
            });
            
            xmlContent += '</Table>\n</Worksheet>\n';
            return xmlContent;
        }
        
        function createSummaryWorksheet(vendorAName, vendorBName, timestamp) {
            let xmlContent = `<Worksheet ss:Name="Summary">\n<Table>\n`;
            
            // Title
            xmlContent += `<Row><Cell ss:StyleID="HeaderStyle" ss:MergeAcross="3"><Data ss:Type="String">RFP Evaluation Summary (${timestamp})</Data></Cell></Row>\n`;
            xmlContent += '<Row></Row>\n';
            
            // Vendor Information
            xmlContent += '<Row><Cell ss:StyleID="CategoryStyle" ss:MergeAcross="3"><Data ss:Type="String">Vendor Information</Data></Cell></Row>\n';
            xmlContent += `<Row><Cell ss:StyleID="DataStyle"><Data ss:Type="String">Vendor A:</Data></Cell><Cell ss:StyleID="DataStyle"><Data ss:Type="String">${escapeXML(vendorAName)}</Data></Cell><Cell></Cell><Cell></Cell></Row>\n`;
            xmlContent += `<Row><Cell ss:StyleID="DataStyle"><Data ss:Type="String">Vendor B:</Data></Cell><Cell ss:StyleID="DataStyle"><Data ss:Type="String">${escapeXML(vendorBName)}</Data></Cell><Cell></Cell><Cell></Cell></Row>\n`;
            xmlContent += '<Row></Row>\n';
            
            // Evaluation Scores if available
            const vendorATotal = document.getElementById('vendorA-weighted-total')?.textContent;
            const vendorBTotal = document.getElementById('vendorB-weighted-total')?.textContent;
            if (vendorATotal && vendorBTotal) {
                xmlContent += '<Row><Cell ss:StyleID="CategoryStyle" ss:MergeAcross="3"><Data ss:Type="String">Evaluation Scores</Data></Cell></Row>\n';
                xmlContent += `<Row><Cell ss:StyleID="DataStyle"><Data ss:Type="String">${escapeXML(vendorAName)} Total Score:</Data></Cell><Cell ss:StyleID="NumberStyle"><Data ss:Type="Number">${vendorATotal}</Data></Cell><Cell></Cell><Cell></Cell></Row>\n`;
                xmlContent += `<Row><Cell ss:StyleID="DataStyle"><Data ss:Type="String">${escapeXML(vendorBName)} Total Score:</Data></Cell><Cell ss:StyleID="NumberStyle"><Data ss:Type="Number">${vendorBTotal}</Data></Cell><Cell></Cell><Cell></Cell></Row>\n`;
            }
            
            xmlContent += '</Table>\n</Worksheet>\n';
            return xmlContent;
        }
        
        function getTableColumnCount(table) {
            const firstRow = table.querySelector('tr');
            if (!firstRow) return 1;
            
            let count = 0;
            const cells = firstRow.querySelectorAll('th, td');
            cells.forEach(cell => {
                const colspan = parseInt(cell.getAttribute('colspan')) || 1;
                count += colspan;
            });
            
            return Math.max(count, 1);
        }
        
        function escapeXML(str) {
            if (typeof str !== 'string') return '';
            return str.replace(/&/g, '&amp;')
                     .replace(/</g, '&lt;')
                     .replace(/>/g, '&gt;')
                     .replace(/"/g, '&quot;')
                     .replace(/'/g, '&apos;')
                     .replace(/[\x00-\x1F\x7F]/g, ''); // Remove control characters
        }
        
        function exportTabToCSV(tabName, tableSelector, vendorAName, vendorBName) {
            const table = document.querySelector(tableSelector);
            if (!table) {
                console.warn(`Table not found: ${tableSelector}`);
                return `"${tabName}"\n"Table not found"\n`;
            }
            
            let csvContent = `"${tabName} (${new Date().toISOString().split('T')[0]})"\n\n`;
            
            const rows = table.querySelectorAll('tr');
            
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('th, td');
                const rowData = [];
                
                cells.forEach((cell, cellIndex) => {
                    let cellContent = '';
                    
                    // Handle colspan by adding empty cells
                    const colspan = parseInt(cell.getAttribute('colspan')) || 1;
                    
                    // Get cell content
                    const input = cell.querySelector('input, select, textarea');
                    if (input) {
                        cellContent = input.value || '';
                    } else {
                        cellContent = cell.textContent.trim();
                    }
                    
                    // Replace vendor placeholders with actual names
                    cellContent = cellContent.replace(/Vendor A/g, vendorAName);
                    cellContent = cellContent.replace(/Vendor B/g, vendorBName);
                    
                    // Escape quotes in CSV
                    cellContent = cellContent.replace(/"/g, '""');
                    
                    // Add the cell content
                    rowData.push(`"${cellContent}"`);
                    
                    // Add empty cells for colspan > 1
                    for (let i = 1; i < colspan; i++) {
                        rowData.push('""');
                    }
                });
                
                csvContent += rowData.join(',') + '\n';
            });
            
            return csvContent;
        }
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            setupAutoSave();
            loadFromLocalStorage();
        });
        
        // Add clear data button functionality (optional - you can add this button to the UI if needed)
        function clearAllData() {
            if (confirm('Are you sure you want to clear all saved data? This action cannot be undone.')) {
                // Clear local storage
                clearLocalStorage();
                
                // Clear all form inputs
                const inputs = document.querySelectorAll('input[type="text"], input[type="number"], select, textarea');
                inputs.forEach(input => {
                    input.value = '';
                });
                
                // Reset vendor names
                const vendorAName = document.getElementById('vendorAName');
                const vendorBName = document.getElementById('vendorBName');
                if (vendorAName) vendorAName.value = '';
                if (vendorBName) vendorBName.value = '';
                
                // Update headers back to default
                updateVendorNames();
                
                // Recalculate scores (will show 0.00)
                calculateScores();
                
                alert('All data has been cleared successfully.');
            }
        }
    </script>
</body>
</html>